---
layout: post  
title: "XJTU-AUTO300527 notes"  
date: 2024-05-29 00:10 +0800  
last_modified_at: 2024-05-29 00:10 +0800  
tags: [Course Note]  
math: true  r
toc: true  
excerpt: "ä¸€äº›ç–‘éš¾ç‚¹çš„è§£å†³ï¼ˆåªæ˜¯ä¸æ‡‚çš„ä¸œè¥¿å¤§æ‚çƒ©ï¼‰"
---

## æ±‚è§£çº¿æ€§å›å½’æ¨¡å‹ï¼ˆp173-178ï¼‰
è®­ç»ƒæ•°æ®ä¸ºğ‘ä¸ªè¾“å…¥æ•°æ®
$$\mathbf{X} =\begin{pmatrix}\mathbf{x_1},\mathbf{x_2},\cdots\mathbf{x_N}
\end{pmatrix}$$
åŠå¯¹åº”å‡½æ•°å€¼
$$\mathbf{t} =\begin{pmatrix}{t_1},{t_2},\cdots{t_N}
\end{pmatrix}$$
æ¨¡å‹ä¸ºçº¿æ€§å›å½’æ¨¡å‹ 
$$y(\mathbf{x},\mathbf{w}) =\mathbf{w}^T\mathbf{\phi(x)}$$

$$
  \mathbf{t} =\begin{pmatrix}
  t_{0}\\
  t_{1} \\
  \vdots \\  
  t_{N}  \\
  \end{pmatrix}_{N \times 1}
$$

$$
  \mathbf{w} =\begin{pmatrix}
  w_{0}\\
  w_{1} \\
  \vdots \\  
  w_{M-1}  \\
  \end{pmatrix}_{(M-1) \times 1}
$$


$$
  \mathbf{\phi}=
  \begin{pmatrix}
  \phi^T(x_1)\\
  \phi^T(x_2)\\
  \vdots \\  
  \phi^T(x_N)\\
  
  \end{pmatrix}=
  \begin{pmatrix}
  \phi_{0}(x_1) & \phi_{1}(x_1) & \phi_{2}(x_1) & \cdots & \phi_{M-1}(x_1)\\
  \phi_{0}(x_2) & \phi_{1}(x_2) & \phi_{2}(x_2) & \cdots & \phi_{M-1}(x_2)\\
  \vdots & \vdots & \ddots & \vdots \\  
  \phi_{0}(x_N) & \phi_{1}(x_N) & \phi_{2}(x_N) & \cdots & \phi_{M-1}(x_N)\\
  \end{pmatrix}_{N\times M}
$$

å› æ­¤å¹³æ–¹å’Œè¯¯å·®å‡½æ•°

$$
 E_D(\mathbf{w})=\frac{1}{2}  \sum_{n=1}^N (t_n-\mathbf{w}^T \mathbf{\phi}(\mathbf{x}_n))^2 $$

 æ±‚å¯¼å¾—

 $$\nabla E_D(\mathbf{w})=\sum_{n=1}^N (t_n-\mathbf{w}^T \mathbf{\phi}(\mathbf{x}_n))\mathbf{\phi}(\mathbf{x}_n)^T 
$$

åˆå¹¶å¯å¾—

$$
\nabla E_D(\mathbf{w}) = \left(
\begin{pmatrix}
t_{0} &t_{1}&\cdots &t_{N}
\end{pmatrix} - \begin{pmatrix}
w_{0} &  w_{1}& \cdots & w_{M-1}
\end{pmatrix} \begin{pmatrix}
\phi(x_1) &  \phi(x_2)& \cdots & \phi(x_N)
\end{pmatrix}\right)

\begin{pmatrix}
\phi^T(x_1)\\
\phi^T(x_2)\\
\vdots \\  
\phi^T(x_N)\\

\end{pmatrix}
$$

å³

$$\nabla E_D(\mathbf{w})= \left(\begin{pmatrix}
t_{0}\\
t_{1} \\
\vdots \\  
t_{N}  \\
\end{pmatrix}^T - \begin{pmatrix}
w_{0}\\
w_{1} \\
\vdots \\  
w_{M-1}  \\
\end{pmatrix}^T \begin{pmatrix}
\phi_{0}(x_1) & \phi_{1}(x_1) & \phi_{2}(x_1) & \cdots & \phi_{M-1}(x_1)\\
\phi_{0}(x_2) & \phi_{1}(x_2) & \phi_{2}(x_2) & \cdots & \phi_{M-1}(x_2)\\
\vdots & \vdots & \ddots & \vdots \\  
\phi_{0}(x_N) & \phi_{1}(x_N) & \phi_{2}(x_N) & \cdots & \phi_{M-1}(x_N)\\
\end{pmatrix}^T\right)\begin{pmatrix}
\phi_{0}(x_1) & \phi_{1}(x_1) & \phi_{2}(x_1) & \cdots & \phi_{M-1}(x_1)\\
\phi_{0}(x_2) & \phi_{1}(x_2) & \phi_{2}(x_2) & \cdots & \phi_{M-1}(x_2)\\
\vdots & \vdots & \ddots & \vdots \\  
\phi_{0}(x_N) & \phi_{1}(x_N) & \phi_{2}(x_N) & \cdots & \phi_{M-1}(x_N)\\
\end{pmatrix}
$$

å³

$$
\nabla E_D(\mathbf{w})=(\mathbf{t}^T-\mathbf{w}^T\mathbf{\Phi}^T)\mathbf{\Phi}
$$

ä»¤å…¶ä¸º0å¯å¾—

$$
\mathbf{t}^T\mathbf{\Phi}=\mathbf{w}^T\mathbf{\Phi}^T\mathbf{\Phi}
$$

$$
(\mathbf{t}^T\mathbf{\Phi})^T=(\mathbf{w}^T\mathbf{\Phi}^T\mathbf{\Phi})^T
$$

$$
\mathbf{\Phi}^T\mathbf{t}=\mathbf{\Phi}^T\mathbf{\Phi}\mathbf{w}
$$

$$
\mathbf{w}_{ML}=(\mathbf{\Phi}^T\mathbf{\Phi})^{-1}\mathbf{\Phi}^T\mathbf{t}
$$

## é€»è¾‘å›å½’

## å‰å¸ƒæ–¯åˆ†å¸ƒ

## éšé©¬å°”å¯å¤«æ¨¡å‹ï¼ˆä¸‰ä¸ªåŸºæœ¬é—®é¢˜ï¼‰

## é‡è¦é‡‡æ ·

åŸºäºå‡è®¾ï¼šæ— æ³•ç›´æ¥ä»p(z)ä¸­é‡‡æ ·ï¼Œä½†å¯¹äºä»»ä¸€ç»™å®šçš„zå€¼ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°è®¡ç®—p(z)çš„å€¼ã€‚ä»¿ç…§æ‹’ç»é‡‡æ ·çš„æ€è·¯ï¼Œå¯ä»¥åˆ©ç”¨æè®®åˆ†å¸ƒ;ä¸æ‹’ç»é‡‡æ ·ä¸åŒçš„æ˜¯ï¼šæè®®åˆ†å¸ƒè¦ä½¿ç”¨**æœ€ä¼˜**çš„é‡‡æ ·å‡½æ•°ï¼Œ**ä¸ç”¨ä¸€å®šå…¨éƒ¨è¦†ç›–**åŸåˆ†å¸ƒå‡½æ•°ï¼›å¹¶ä¸”æ‰€æœ‰ç”Ÿæˆçš„æ ·æœ¬éƒ½ä¼šè¢«ä¿ç•™ã€‚

å¦‚æœç›´æ¥ä»p(z)ä¸­é‡‡æ ·ï¼Œå¦‚æœæœ‰æœä»p(z)çš„Lä¸ªç‹¬ç«‹æ ·æœ¬ï¼Œå°±å¯ä»¥ä»

$$
E(f)=\int f(\mathbf{z})p(\mathbf{z})d\mathbf{z}
$$

è¿‡æ¸¡åˆ°

$$
f\approx\frac{1}{L}  \sum_{l=1}^L f(\mathbf{z}^{(l)})
$$

å› æ­¤æˆ‘ä»¬å¯ä»¥ä»q(z)ä¸­é‡‡æ ·ï¼Œä¹˜ä¸€ä¸ªç³»æ•°ï¼Œå°†q(z)å½“ä½œp(z)çš„ä½œç”¨ï¼Œä»

$$
E(f)=\int f(\mathbf{z})\frac{p(\mathbf{z})}{q(\mathbf{z})} q(\mathbf{z})d\mathbf{z}
$$

è¿‡æ¸¡åˆ°

$$
\hat f\approx\frac{1}{L}  \sum_{l=1}^L \frac{p(\mathbf{z}^{(l)})}{q(\mathbf{z}^{(l)})}f(\mathbf{z}^{(l)})
$$

ä¹˜ä¸Šçš„è¿™ä¸ªç³»æ•°æ˜¯**é‡è¦æ€§æƒé‡**

$$
r_l=\frac{p(\mathbf{z}^{(l)})}{q(\mathbf{z}^{(l)})}
$$

æ­¤å¤–é‡‡æ ·å¾—åˆ°çš„éœ€è¦å½’ä¸€åŒ–ï¼Œå› æ­¤å¼•å…¥

$$
p(\mathbf{z})= \frac{1}{Z_p} \tilde p(\mathbf{z})
$$

$$
q(\mathbf{z})= \frac{1}{Z_q} \tilde q(\mathbf{z})
$$

è¿™æ ·æœŸæœ›å°±å˜æˆäº†

$$
E(f)=\int f(\mathbf{z})p(\mathbf{z})d\mathbf{z}
=\int f(\mathbf{z})\frac{p(\mathbf{z})}{q(\mathbf{z})} q(\mathbf{z})d\mathbf{z}
=\frac{Z_q}{Z_p} \int f(\mathbf{z})\frac{\tilde p(\mathbf{z})}{ \tilde q(\mathbf{z})}  q(\mathbf{z})d\mathbf{z}
$$

$$
\approx\frac{Z_q}{Z_p} \frac{1}{L}  \sum_{l=1}^L \frac{\tilde p(\mathbf{z}^{(l)})}{\tilde q(\mathbf{z}^{(l)})}f(\mathbf{z}^{(l)})
=\frac{Z_q}{Z_p} \frac{1}{L}  \sum_{l=1}^L \tilde r_l f(\mathbf{z}^{(l)})
=\frac{Z_q}{\int \tilde p(\mathbf{z})d\mathbf{z}} \frac{1}{L}  \sum_{l=1}^L \tilde r_l f(\mathbf{z}^{(l)})
$$

$$
=\frac{Z_q}{\int \frac {\tilde p(\mathbf{z})}{\frac{\tilde q(\mathbf{z})}{Z_q}} q(\mathbf{z}) d\mathbf{z}} \frac{1}{L}  \sum_{l=1}^L \tilde r_l f(\mathbf{z}^{(l)})
=\frac{\frac{1}{L}  \sum_{l=1}^L \tilde r_l f(\mathbf{z}^{(l)})}{\int \frac {\tilde p(\mathbf{z})}{\tilde q(\mathbf{z})} q(\mathbf{z}) d\mathbf{z}} 
=\frac{\frac{1}{L}  \sum_{l=1}^L \tilde r_l f(\mathbf{z}^{(l)})}{\frac{1}{L}  \sum_{l=1}^L \tilde r_l } 
$$

$$
=\frac{  \sum_{l=1}^L \tilde r_l f(\mathbf{z}^{(l)})}{  \sum_{l=1}^L \tilde r_l } 
=\sum_{l=1}^L\frac{   \tilde r_l }{  \sum_{m=1}^M \tilde r_m } f(\mathbf{z}^{(l)})
=\sum_{l=1}^L\frac{   \frac{\tilde p(\mathbf{z}^{(l)})}{\tilde q(\mathbf{z}^{(l)})} }{  \sum_{m=1}^M \frac{\tilde p(\mathbf{z}^{(m)})}{\tilde q(\mathbf{z}^{(m)})} } f(\mathbf{z}^{(l)})
=\sum_{l=1}^Lw_l f(\mathbf{z}^{(l)})
$$

## Metropolis-Hastingæ–¹æ³•ï¼ˆp525-526ï¼‰

