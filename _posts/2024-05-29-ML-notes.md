---
layout: post  
title: "XJTU-AUTO300527 notes"  
date: 2024-05-29 00:10 +0800  
last_modified_at: 2024-05-29 00:10 +0800  
tags: [Course Note]  
math: true  r
toc: true  
excerpt: "一些疑难点的解决（TBC）"
---

## 求解线性回归模型（p173-178）
训练数据为𝑁个输入数据
$$\mathbf{X} =\begin{pmatrix}\mathbf{x_1},\mathbf{x_2},\cdots\mathbf{x_N}
\end{pmatrix}$$
及对应函数值
$$\mathbf{t} =\begin{pmatrix}{t_1},{t_2},\cdots{t_N}
\end{pmatrix}$$
模型为线性回归模型 
$$y(\mathbf{x},\mathbf{w}) =\mathbf{w}^T\mathbf{\phi(x)}$$

$$
  \mathbf{t} =\begin{pmatrix}
  t_{0}\\
  t_{1} \\
  \vdots \\  
  t_{N}  \\
  \end{pmatrix}_{N \times 1}
$$

$$
  \mathbf{w} =\begin{pmatrix}
  w_{0}\\
  w_{1} \\
  \vdots \\  
  w_{M-1}  \\
  \end{pmatrix}_{M-1 \times 1}
$$


$$
  \mathbf{\phi}=
  \begin{pmatrix}
  \phi^T(x_1)\\
  \phi^T(x_2)\\
  \vdots \\  
  \phi^T(x_N)\\
  
  \end{pmatrix}=
  \begin{pmatrix}
  \phi_{0}(x_1) & \phi_{1}(x_1) & \phi_{2}(x_1) & \cdots & \phi_{M-1}(x_1)\\
  \phi_{0}(x_2) & \phi_{1}(x_2) & \phi_{2}(x_2) & \cdots & \phi_{M-1}(x_2)\\
  \vdots & \vdots & \ddots & \vdots \\  
  \phi_{0}(x_N) & \phi_{1}(x_N) & \phi_{2}(x_N) & \cdots & \phi_{M-1}(x_N)\\
  \end{pmatrix}_{N\times M}
$$

因此平方和误差函数

$$
 E_D(\mathbf{w})=\frac{1}{2}  \sum_{n=1}^N (t_n-\mathbf{w}^T \mathbf{\phi}(\mathbf{x}_n))^2 $$
 求导得
 $$\nabla E_D(\mathbf{w})=\sum_{n=1}^N (t_n-\mathbf{w}^T \mathbf{\phi}(\mathbf{x}_n))\mathbf{\phi}(\mathbf{x}_n)^T 
$$

合并可得

$$
\nabla E_D(\mathbf{w}) = \left(
\begin{pmatrix}
t_{0} &t_{1}&\cdots &t_{N}
\end{pmatrix} - \begin{pmatrix}
w_{0} &  w_{1}& \cdots & w_{M-1}
\end{pmatrix} \begin{pmatrix}
\phi(x_1) &  \phi(x_2)& \cdots & \phi(x_N)
\end{pmatrix}\right)

\begin{pmatrix}
\phi^T(x_1)\\
\phi^T(x_2)\\
\vdots \\  
\phi^T(x_N)\\

\end{pmatrix}
$$

即

$$\nabla E_D(\mathbf{w})= \left(\begin{pmatrix}
t_{0}\\
t_{1} \\
\vdots \\  
t_{N}  \\
\end{pmatrix}^T - \begin{pmatrix}
w_{0}\\
w_{1} \\
\vdots \\  
w_{M-1}  \\
\end{pmatrix}^T \begin{pmatrix}
\phi_{0}(x_1) & \phi_{1}(x_1) & \phi_{2}(x_1) & \cdots & \phi_{M-1}(x_1)\\
\phi_{0}(x_2) & \phi_{1}(x_2) & \phi_{2}(x_2) & \cdots & \phi_{M-1}(x_2)\\
\vdots & \vdots & \ddots & \vdots \\  
\phi_{0}(x_N) & \phi_{1}(x_N) & \phi_{2}(x_N) & \cdots & \phi_{M-1}(x_N)\\
\end{pmatrix}^T\right)\begin{pmatrix}
\phi_{0}(x_1) & \phi_{1}(x_1) & \phi_{2}(x_1) & \cdots & \phi_{M-1}(x_1)\\
\phi_{0}(x_2) & \phi_{1}(x_2) & \phi_{2}(x_2) & \cdots & \phi_{M-1}(x_2)\\
\vdots & \vdots & \ddots & \vdots \\  
\phi_{0}(x_N) & \phi_{1}(x_N) & \phi_{2}(x_N) & \cdots & \phi_{M-1}(x_N)\\
\end{pmatrix}
$$

即

$$
\nabla E_D(\mathbf{w})=(\mathbf{t}^T-\mathbf{w}^T\mathbf{\Phi}^T)\mathbf{\Phi}
$$

令其为0可得

$$
\mathbf{t}^T\mathbf{\Phi}=\mathbf{w}^T\mathbf{\Phi}^T\mathbf{\Phi}
$$

$$
(\mathbf{t}^T\mathbf{\Phi})^T=(\mathbf{w}^T\mathbf{\Phi}^T\mathbf{\Phi})^T
$$

$$
\mathbf{\Phi}^T\mathbf{t}=\mathbf{\Phi}^T\mathbf{\Phi}\mathbf{w}
$$

$$
\mathbf{w}_{ML}=(\mathbf{\Phi}^T\mathbf{\Phi})^{-1}\mathbf{\Phi}^T\mathbf{t}
$$
